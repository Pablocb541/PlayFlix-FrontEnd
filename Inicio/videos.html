<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" href="/styles/videos.css">
</head>
<body>
  <h1>Videos</h1>

  <!-- Contenedor donde se mostrarÃ¡n los videos -->
  <div id="videoContainer"></div>

  <script>
    // Clase para extraer y mostrar los videos
    class YouTubeLinkExtractor {
      constructor(apiUrl) {
        this.apiUrl = apiUrl;
      }

      async fetchVideos() {
        try {
          const response = await fetch(this.apiUrl);
          const data = await response.json();
          return data;
        } catch (error) {
          console.error('Error fetching videos:', error);
          return [];
        }
      }

      async renderVideos(containerId) {
        const videos = await this.fetchVideos();
        const container = document.getElementById(containerId);
        if (!container) {
          console.error(`Container element with ID ${containerId} not found.`);
          return;
        }
        container.innerHTML = ''; // Limpiar el contenedor antes de agregar los videos

        for (let i = 0; i < videos.length; i++) {
          const video = videos[i];
          const videoId = this.extractVideoId(video.youtubeUrl);
          const videoContainer = document.createElement('div');
          videoContainer.classList.add('video-container');

          // Agregar evento de clic al contenedor de video
          videoContainer.addEventListener('click', () => {
            videoContainer.innerHTML = `<iframe width="480" height="270" src="https://www.youtube.com/embed/${videoId}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
          });
          
          const thumbnail = document.createElement('img');
          thumbnail.src = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
          thumbnail.alt = 'Video Thumbnail';
          thumbnail.classList.add('video-thumbnail');

          const overlay = document.createElement('div');
          overlay.classList.add('video-overlay');
          overlay.innerHTML = `
            <div class="video-title">${video.name}</div>
          `;

          videoContainer.appendChild(thumbnail);
          videoContainer.appendChild(overlay);

          container.appendChild(videoContainer);
        }
      }

      extractVideoId(youtubeUrl) {
        const url = new URL(youtubeUrl);
        const videoId = url.searchParams.get('v');
        return videoId;
      }
    }

    // Uso de la clase YouTubeLinkExtractor
    const extractor = new YouTubeLinkExtractor('http://localhost:3001/api/videos'); // Reemplaza la URL por la ruta correcta de tu API
    extractor.renderVideos('videoContainer'); // Reemplaza 'videoContainer' por el ID del contenedor HTML donde deseas mostrar los videos
  </script>
</body>
</html>
